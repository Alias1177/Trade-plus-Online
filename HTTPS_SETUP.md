# üîí HTTPS Setup Guide –¥–ª—è Trader Plus

–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ HTTPS —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏ –æ—Ç Let's Encrypt.

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

‚úÖ **–î–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω**: `trader-plus.online` –¥–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä (69.62.112.20)  
‚úÖ **–ü—Ä–æ–µ–∫—Ç –∑–∞–ø—É—â–µ–Ω**: Backend –∏ frontend —Ä–∞–±–æ—Ç–∞—é—Ç  
‚úÖ **–ü–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã**: 80 –∏ 443 –¥–æ—Å—Ç—É–ø–Ω—ã  

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤
```bash
# –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x init-letsencrypt.sh
chmod +x setup-ssl-renewal.sh
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SSL
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /opt/tradeplus
./init-letsencrypt.sh
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```bash
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
./setup-ssl-renewal.sh
```

## üîß –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –¥–æ–º–µ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
```bash
dig trader-plus.online
nslookup trader-plus.online
```

### –®–∞–≥ 2: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```bash
cd /opt/tradeplus
docker compose -f docker-compose.prod.yml down
```

### –®–∞–≥ 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
# –ü–æ–¥—Ç—è–Ω—É—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å HTTPS –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
docker compose -f docker-compose.prod.yml build --no-cache frontend
```

### –®–∞–≥ 4: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SSL
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
./init-letsencrypt.sh
```

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç:
1. üìÅ –°–æ–∑–¥–∞—Å—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
2. üîß –°–æ–∑–¥–∞—Å—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
3. üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç nginx
4. üîê –ü–æ–ª—É—á–∏—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
5. üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç nginx —Å HTTPS

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```bash
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
./setup-ssl-renewal.sh
```

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl -I https://trader-plus.online

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ
echo | openssl s_client -servername trader-plus.online -connect trader-plus.online:443 2>/dev/null | openssl x509 -noout -text
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤
```bash
# HTTP –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ HTTPS
curl -I http://trader-plus.online
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API —á–µ—Ä–µ–∑ HTTPS
```bash
# –¢–µ—Å—Ç API endpoint
curl -X GET https://trader-plus.online/health

# –¢–µ—Å—Ç POST –∑–∞–ø—Ä–æ—Å–∞
curl -X POST https://trader-plus.online/insert \
  -H "Content-Type: application/json" \
  -d '{"selected_id": "Id1", "number": "1234567890", "email": "test@example.com", "TGNikName": "testuser"}'
```

## üîÑ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **Cron job** –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è 2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å (2:30 –∏ 14:30)
- **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç** –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- **–û–±–Ω–æ–≤–ª—è–µ—Ç** —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –µ—Å–ª–∏ –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è < 30 –¥–Ω–µ–π
- **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç** nginx –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
./test-ssl-renewal.sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
tail -f /opt/tradeplus/ssl-renewal.log

# –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
./renew-ssl.sh
```

## üõ†Ô∏è Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞ 1: DNS –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
**–°–∏–º–ø—Ç–æ–º**: `Failed to obtain SSL certificate`
**–†–µ—à–µ–Ω–∏–µ**: 
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DNS
dig trader-plus.online A
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 69.62.112.20
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü–æ—Ä—Ç—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
**–°–∏–º–ø—Ç–æ–º**: Connection timeout
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã
netstat -tulpn | grep :80
netstat -tulpn | grep :443

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall
ufw status
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Nginx –æ—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–°–∏–º–ø—Ç–æ–º**: Nginx –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
docker compose -f docker-compose.prod.yml exec frontend nginx -t

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose -f docker-compose.prod.yml logs frontend
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
**–°–∏–º–ø—Ç–æ–º**: –°—Ç–∞—Ä—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å cron
crontab -l

# –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
./renew-ssl.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
cat /opt/tradeplus/ssl-renewal.log
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ SSL

```
/opt/tradeplus/
‚îú‚îÄ‚îÄ certbot/
‚îÇ   ‚îú‚îÄ‚îÄ conf/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Let's Encrypt
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ live/trader-plus.online/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fullchain.pem    # –ü–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ privkey.pem      # –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ chain.pem        # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ options-ssl-nginx.conf
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ssl-dhparams.pem
‚îÇ   ‚îî‚îÄ‚îÄ www/               # Webroot –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–º–µ–Ω–∞
‚îú‚îÄ‚îÄ init-letsencrypt.sh    # –°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ SSL
‚îú‚îÄ‚îÄ setup-ssl-renewal.sh   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ renew-ssl.sh          # –°–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ ssl-renewal.log       # –õ–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **TLS 1.2/1.3** —Ç–æ–ª—å–∫–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã
- **HSTS** –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS
- **Perfect Forward Secrecy** –∑–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
- **OCSP Stapling** –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∑—ã–≤–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```bash
# SSL Labs —Ç–µ—Å—Ç (–æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
# https://www.ssllabs.com/ssltest/analyze.html?d=trader-plus.online

# –¢–µ—Å—Ç —Å –ø–æ–º–æ—â—å—é testssl.sh
docker run --rm -ti drwetter/testssl.sh trader-plus.online
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ SSL
```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
cat > /opt/tradeplus/ssl-monitor.sh << 'EOF'
#!/bin/bash
echo "üîç SSL Certificate Status for trader-plus.online"
echo "================================================"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
EXPIRY=$(echo | openssl s_client -servername trader-plus.online -connect trader-plus.online:443 2>/dev/null | openssl x509 -noout -enddate | cut -d= -f2)
echo "üìÖ Certificate expires: $EXPIRY"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
HTTP_CODE=$(curl -s -o /dev/null -w "%{http_code}" https://trader-plus.online)
echo "üåê HTTPS Status: $HTTP_CODE"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
HTTP_REDIRECT=$(curl -s -o /dev/null -w "%{http_code}" http://trader-plus.online)
echo "üîÑ HTTP Redirect: $HTTP_REDIRECT"
EOF

chmod +x /opt/tradeplus/ssl-monitor.sh
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

‚úÖ **https://trader-plus.online** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∑–µ–ª–µ–Ω—ã–º –∑–∞–º–∫–æ–º  
‚úÖ **http://trader-plus.online** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ HTTPS  
‚úÖ **API endpoints** –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ HTTPS  
‚úÖ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∫–∞–∂–¥—ã–µ 60 –¥–Ω–µ–π  
‚úÖ **A+ —Ä–µ–π—Ç–∏–Ω–≥** –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ SSL

---

**üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í–∞—à —Å–∞–π—Ç —Ç–µ–ø–µ—Ä—å –∑–∞—â–∏—â–µ–Ω HTTPS!** üîí 